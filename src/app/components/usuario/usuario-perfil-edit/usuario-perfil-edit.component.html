<div class="card">
    <header class="card-header perfil-header">
        <h4>Mi Perfil</h4>
    </header>
    <article class="card-body ">

        <!-- ==================== Form ===================== -->
        <form class="needs-validation" autocomplete="off" novalidate [formGroup]="fg">
            <div class="form-row">
                <div class="col">
                    <label for="txtNombre" class="control-label">Nombre</label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"> <i class="fas fa-user"></i> </span>
                        </div>
                        <input id="txtNombre" formControlName="nombre" type="text" class="form-control">

                    </div>
                    <app-field-error-display [displayError]="nombre.touched && nombre.errors?.required"
                                             errorMsg="* Debe completar el nombre">
                    </app-field-error-display>
                    <app-field-error-display [displayError]="nombre.touched && nombre.errors?.minlength"
                                             errorMsg="* El nombre debe tener al menos 2 letras">
                    </app-field-error-display>
                    <app-field-error-display [displayError]="nombre.touched && nombre.errors?.maxlength"
                                             errorMsg="* El nombre no puede tener más de 100 letras">
                    </app-field-error-display>
                </div>

                <div class="col">
                    <label for="txtApellido">Apellido</label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"> <i class="far fa-user"></i> </span>
                        </div>
                        <input id="txtApellido" formControlName="apellido" type="text" class="form-control">
                    </div>
                    <app-field-error-display [displayError]="apellido.touched && apellido.errors?.required"
                                             errorMsg="* Debe completar el apellido">
                    </app-field-error-display>
                    <app-field-error-display [displayError]="apellido.touched && apellido.errors?.minlength"
                                             errorMsg="* El apellido debe tener al menos 2 letras">
                    </app-field-error-display>
                    <app-field-error-display [displayError]="apellido.touched && apellido.errors?.maxlength"
                                             errorMsg="* El apellido no puede tener más de 100 letras">
                    </app-field-error-display>

                </div>

            </div>

            <div class="form-row">
                <div class="col">
                    <label for="txtUser">Nombre de Usuario</label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"> <i class="fas fa-user-circle"></i> </span>
                        </div>
                        <input id="txtUser" formControlName="username" type="text" readonly
                               class="form-control">
                    </div>

                </div>
                <div class="col">
                    <label for="txtDni">DNI</label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"> <i class="fas fa-fingerprint"></i> </span>
                        </div>
                        <input id="txtDni" formControlName="numeroIdentificacion" OnlyNumber="true" type="text"
                               class="form-control">
                    </div>
                    <app-field-error-display [displayError]="dni.touched && dni.errors?.required"
                                             errorMsg="* Debe completar el DNI">
                    </app-field-error-display>
                    <app-field-error-display [displayError]="dni.touched && dni.errors?.minlength"
                                             errorMsg="* El DNI debe tener entre 7 y 8 dígitos">
                    </app-field-error-display>
                    <app-field-error-display [displayError]="dni.touched && dni.errors?.maxlength"
                                             errorMsg="* El DNI debe tener entre 7 y 8 dígitos">
                    </app-field-error-display>
                </div>
            </div>



            <!-- ================== Calificacion ================== -->
            <div class="form-row">
                <div class="col">
                    <label for="txtEmail">eMail</label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"> <i class="fas fa-envelope"></i> </span>
                        </div>
                        <input id="txtEmail" formControlName="email" type="email" class="form-control">
                    </div>
                    <app-field-error-display [displayError]="email.touched && email.errors?.required"
                                             errorMsg="* Debe completar el email y este debe ser un correo valido">
                    </app-field-error-display>
                    <app-field-error-display [displayError]="email.touched && email.errors?.correo"
                                             errorMsg="* No parece ser una dirección de mail">
                    </app-field-error-display>
                    <small class="form-text text-muted">No comrpatiremos tu email con nadie.</small>
                </div>

                <div class="col" *ngIf="usuario.calificacion">
                    <label>Calificación General</label>
                    <div class="rate">
                        <ng-template #t let-fill="fill">
                          <span class="star" [class.full]="fill === 100">
                            <span class="half" [style.width.%]="fill">&#9733;</span>&#9733;
                          </span>
                        </ng-template>

                        <ngb-rating [(rate)]="usuario.calificacion" [starTemplate]="t" [readonly]="true" [max]="5"></ngb-rating>
                    </div>
                </div>
            </div>

            <!-- ================== Teléfonos ================== -->
            <div class="form-row my-3">
                <div class="col">
                    <label for="txtCellphone">Número de Teléfono (Celular)</label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"> <i class="fas fa-mobile-alt"></i> </span>
                        </div>
                        <input id="txtCellphone" formControlName="telefonoMovil" type="text" class="form-control">
                    </div>
                    <app-field-error-display [displayError]="telCel.touched && telCel.errors?.required"
                                             errorMsg="* Debe completar el número del teléfono celular">
                    </app-field-error-display>
                    <app-field-error-display [displayError]="telCel.touched && telCel.errors?.telefono"
                                             errorMsg="* Solo debe ingresar números y/o los signos + - para indicar país y región">
                    </app-field-error-display>
                    <app-field-error-display [displayError]="telCel.touched && telCel.errors?.minlength"
                                             errorMsg="* El teléfono debe tener al menos 10 números">
                    </app-field-error-display>
                </div>
                <div class="col">
                    <label for="txtPhone">Número de Teléfono (Fijo)</label>
                    <div class="input-group mb-3">
                        <div class="input-group-prepend">
                            <span class="input-group-text"> <i class="fas fa-phone-alt"></i> </span>
                        </div>
                        <input id="txtPhone" formControlName="telefonoFijo" type="text" class="form-control">
                    </div>
                    <app-field-error-display
                            [displayError]="telFijo.touched && telFijo.value?.toString().length > 0 && telFijo.errors?.telefono"
                            errorMsg="* Solo debe ingresar números y/o los signos + - para indicar país y región">
                    </app-field-error-display>
                    <app-field-error-display
                            [displayError]="telFijo.touched && telFijo.value?.toString().length > 0 && telFijo.errors?.minlength"
                            errorMsg="* El teléfono debe tener al menos 10 números">
                    </app-field-error-display>
                </div>
            </div>

            <div class="form-row">
                <div class="col">
                    <button type="button" (click)="cambiarPassword.emit()" class="btn btn-secondary btn-block"> Cambiar contraseña </button>
                </div>
                <div class="col">
                    <button type="submit" class="btn btn-primary btn-block" [disabled]="fg.pristine || !fg.valid" (click)="onSubmit()"> Guardar cambios </button>
                </div>
            </div> <!-- form-group// -->
        </form>
    </article> <!-- card-body end .// -->
</div> <!-- End Card -->

